{"ast":null,"code":"// frontend/src/services/authService.js\nimport axios from'axios';const API_BASE_URL=process.env.REACT_APP_API_URL||'http://localhost:5000/api';const api=axios.create({baseURL:API_BASE_URL,headers:{'Content-Type':'application/json'}});// ---- Token sur chaque requête\napi.interceptors.request.use(config=>{const token=localStorage.getItem('us_token');if(token)config.headers.Authorization=\"Bearer \".concat(token);return config;});// ---- Gestion 401 / 409 globalement\napi.interceptors.response.use(res=>res,error=>{var _error$response,_error$response2;const status=(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status;const data=(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.data;if(status===401){localStorage.removeItem('us_token');localStorage.removeItem('us_user');window.location.href='/';}if(status===409&&(data===null||data===void 0?void 0:data.error)==='not_in_couple'){if(window.location.pathname!=='/onboarding-couple'){window.location.href='/onboarding-couple';}}return Promise.reject(error);});// ---- Auth\nexport const authService={login:async(email,password)=>(await api.post('/login',{email,password})).data,register:async(name,email,password)=>(await api.post('/register',{name,email,password})).data,getUsers:async()=>(await api.get('/users')).data};// ---- Couple\nexport const coupleService={me:async()=>(await api.get('/couple/me')).data,create:async()=>(await api.post('/couple/create')).data,join:async invite_code=>(await api.post('/couple/join',{invite_code})).data,refreshInvite:async()=>(await api.post('/couple/invite/refresh')).data};// ---- Reminders\nexport const reminderService={getAll:async()=>(await api.get('/reminders')).data,create:async reminder=>(await api.post('/reminders',reminder)).data,update:async(id,updates)=>(await api.put(\"/reminders/\".concat(id),updates)).data,delete:async id=>(await api.delete(\"/reminders/\".concat(id))).data};// ---- Restaurants\nexport const restaurantService={getAll:async()=>(await api.get('/restaurants')).data,create:async restaurant=>(await api.post('/restaurants',restaurant)).data,update:async(id,updates)=>(await api.put(\"/restaurants/\".concat(id),updates)).data,delete:async id=>(await api.delete(\"/restaurants/\".concat(id))).data};// ---- Activities\nexport const activityService={getAll:async()=>(await api.get('/activities')).data,create:async activity=>(await api.post('/activities',activity)).data,update:async(id,updates)=>(await api.put(\"/activities/\".concat(id),updates)).data,delete:async id=>(await api.delete(\"/activities/\".concat(id))).data};// ---- Wishlist\nexport const wishlistService={getAll:async()=>(await api.get('/wishlist')).data,create:async item=>(await api.post('/wishlist',item)).data,update:async(id,updates)=>(await api.put(\"/wishlist/\".concat(id),updates)).data,delete:async id=>(await api.delete(\"/wishlist/\".concat(id))).data};// ---- Photos\nexport const photoService={getAll:async()=>(await api.get('/photos')).data,create:async photo=>(await api.post('/photos',photo)).data};// ---- Notes\nexport const noteService={getAll:async()=>(await api.get('/notes')).data,create:async note=>(await api.post('/notes',note)).data,update:async(id,updates)=>(await api.put(\"/notes/\".concat(id),updates)).data,delete:async id=>(await api.delete(\"/notes/\".concat(id))).data};export default api;","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","api","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","concat","response","res","error","_error$response","_error$response2","status","data","removeItem","window","location","href","pathname","Promise","reject","authService","login","email","password","post","register","name","getUsers","get","coupleService","me","join","invite_code","refreshInvite","reminderService","getAll","reminder","update","id","updates","put","delete","restaurantService","restaurant","activityService","activity","wishlistService","item","photoService","photo","noteService","note"],"sources":["C:/Users/sorbo/US/us-app/frontend/src/services/authService.js"],"sourcesContent":["// frontend/src/services/authService.js\r\nimport axios from 'axios';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\n\r\nconst api = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  headers: { 'Content-Type': 'application/json' },\r\n});\r\n\r\n// ---- Token sur chaque requête\r\napi.interceptors.request.use((config) => {\r\n  const token = localStorage.getItem('us_token');\r\n  if (token) config.headers.Authorization = `Bearer ${token}`;\r\n  return config;\r\n});\r\n\r\n// ---- Gestion 401 / 409 globalement\r\napi.interceptors.response.use(\r\n  (res) => res,\r\n  (error) => {\r\n    const status = error.response?.status;\r\n    const data = error.response?.data;\r\n\r\n    if (status === 401) {\r\n      localStorage.removeItem('us_token');\r\n      localStorage.removeItem('us_user');\r\n      window.location.href = '/';\r\n    }\r\n    if (status === 409 && data?.error === 'not_in_couple') {\r\n      if (window.location.pathname !== '/onboarding-couple') {\r\n        window.location.href = '/onboarding-couple';\r\n      }\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// ---- Auth\r\nexport const authService = {\r\n  login: async (email, password) => (await api.post('/login', { email, password })).data,\r\n  register: async (name, email, password) =>\r\n    (await api.post('/register', { name, email, password })).data,\r\n  getUsers: async () => (await api.get('/users')).data,\r\n};\r\n\r\n// ---- Couple\r\nexport const coupleService = {\r\n  me: async () => (await api.get('/couple/me')).data,\r\n  create: async () => (await api.post('/couple/create')).data,\r\n  join: async (invite_code) => (await api.post('/couple/join', { invite_code })).data,\r\n  refreshInvite: async () => (await api.post('/couple/invite/refresh')).data,\r\n};\r\n\r\n// ---- Reminders\r\nexport const reminderService = {\r\n  getAll: async () => (await api.get('/reminders')).data,\r\n  create: async (reminder) => (await api.post('/reminders', reminder)).data,\r\n  update: async (id, updates) => (await api.put(`/reminders/${id}`, updates)).data,\r\n  delete: async (id) => (await api.delete(`/reminders/${id}`)).data,\r\n};\r\n\r\n// ---- Restaurants\r\nexport const restaurantService = {\r\n  getAll: async () => (await api.get('/restaurants')).data,\r\n  create: async (restaurant) => (await api.post('/restaurants', restaurant)).data,\r\n  update: async (id, updates) => (await api.put(`/restaurants/${id}`, updates)).data,\r\n  delete: async (id) => (await api.delete(`/restaurants/${id}`)).data,\r\n};\r\n\r\n// ---- Activities\r\nexport const activityService = {\r\n  getAll: async () => (await api.get('/activities')).data,\r\n  create: async (activity) => (await api.post('/activities', activity)).data,\r\n  update: async (id, updates) => (await api.put(`/activities/${id}`, updates)).data,\r\n  delete: async (id) => (await api.delete(`/activities/${id}`)).data,\r\n};\r\n\r\n// ---- Wishlist\r\nexport const wishlistService = {\r\n  getAll: async () => (await api.get('/wishlist')).data,\r\n  create: async (item) => (await api.post('/wishlist', item)).data,\r\n  update: async (id, updates) => (await api.put(`/wishlist/${id}`, updates)).data,\r\n  delete: async (id) => (await api.delete(`/wishlist/${id}`)).data,\r\n};\r\n\r\n// ---- Photos\r\nexport const photoService = {\r\n  getAll: async () => (await api.get('/photos')).data,\r\n  create: async (photo) => (await api.post('/photos', photo)).data,\r\n};\r\n\r\n// ---- Notes\r\nexport const noteService = {\r\n  getAll: async () => (await api.get('/notes')).data,\r\n  create: async (note) => (await api.post('/notes', note)).data,\r\n  update: async (id, updates) => (await api.put(`/notes/${id}`, updates)).data,\r\n  delete: async (id) => (await api.delete(`/notes/${id}`)).data,\r\n};\r\n\r\nexport default api;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}