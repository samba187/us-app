{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/sorbo/US/us-app/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject0,_templateObject1;import React,{useEffect,useState}from'react';import styled from'styled-components';import{coupleService}from'../services/authService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Wrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"max-width:860px;margin:40px auto;padding:24px;display:grid;gap:32px;grid-template-columns:repeat(auto-fit,minmax(340px,1fr));\"])));const Panel=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"background:#fff;border-radius:28px;padding:32px 28px;box-shadow:0 12px 32px -8px rgba(0,0,0,0.12);position:relative;overflow:hidden;\"])));const Title=styled.h2(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"margin:0 0 6px;font-size:26px;font-weight:700;background:linear-gradient(135deg,#ff6b8a,#4ecdc4);-webkit-background-clip:text;-webkit-text-fill-color:transparent;\"])));const Sub=styled.p(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"margin:0 0 20px;color:#555;font-size:14px;line-height:1.5;\"])));const CodeBox=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"font-size:40px;font-weight:700;letter-spacing:6px;font-family:'Courier New',monospace;background:#f3f5f7;border:3px dashed #d6dce2;padding:22px 10px;text-align:center;border-radius:22px;user-select:all;\"])));const ButtonsRow=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"display:flex;flex-wrap:wrap;gap:12px;margin-top:22px;\"])));const Btn=styled.button(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"flex:1;padding:14px 16px;border:none;border-radius:16px;font-weight:600;font-size:15px;cursor:pointer;background:\",\";color:\",\";display:flex;align-items:center;justify-content:center;gap:6px;transition:transform .25s,box-shadow .25s;&:hover{transform:translateY(-2px);box-shadow:0 6px 18px rgba(0,0,0,0.18);} &:disabled{opacity:.55;cursor:not-allowed;transform:none;box-shadow:none;}\"])),p=>p.variant==='secondary'?'#eef1f5':'linear-gradient(135deg,#ff6b8a,#4ecdc4)',p=>p.variant==='secondary'?'#333':'#fff');const JoinForm=styled.form(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"display:flex;flex-direction:column;gap:18px;\"])));const Input=styled.input(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"padding:15px 18px;font-size:20px;letter-spacing:4px;text-transform:uppercase;text-align:center;border:2px solid #d9dee4;border-radius:18px;font-weight:600;outline:none;transition:border-color .25s,box-shadow .25s;background:#fff;&:focus{border-color:#ff6b8a;box-shadow:0 0 0 4px rgba(255,107,138,.25);} \"])));const Alert=styled.div(_templateObject0||(_templateObject0=_taggedTemplateLiteral([\"margin-top:18px;padding:14px 18px;border-radius:16px;font-size:14px;font-weight:500;line-height:1.4;background:\",\";color:\",\";\"])),p=>p.type==='error'?'#ffe4e8':p.type==='success'?'#e6fff5':'#f1f4f8',p=>p.type==='error'?'#b50024':p.type==='success'?'#036245':'#39424e');const Small=styled.div(_templateObject1||(_templateObject1=_taggedTemplateLiteral([\"margin-top:10px;font-size:12px;color:#7a838c;text-align:center;\"])));export default function OnboardingCouple(){const[loadingCreate,setLoadingCreate]=useState(false);const[loadingJoin,setLoadingJoin]=useState(false);const[inviteCode,setInviteCode]=useState('');const[existing,setExisting]=useState(false);const[joinCode,setJoinCode]=useState('');const[message,setMessage]=useState(null);// {type:'success'|'error'|'info', text:string}\n// RÃ©cupÃ¨re code existant si dÃ©jÃ  crÃ©Ã© cotÃ© backend\nuseEffect(()=>{(async()=>{try{const cm=await coupleService.me();if(cm.invite_code){setInviteCode(cm.invite_code);setExisting(true);}if(cm.in_couple){// dÃ©jÃ  en couple -> skip page\nwindow.location.href='/';}}catch(_unused){/* ignorÃ© */}})();},[]);const createOrRefresh=async function(){let refresh=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;setMessage(null);setLoadingCreate(true);try{let code=inviteCode;if(!code||refresh){// create renvoie un code (dans notre backend logique: crÃ©e le couple si inexistant ou refresh invite)\nconst res=await coupleService.create();code=res.invite_code||res.code||res.invite||'';}if(!code)throw new Error('Code indisponible');setInviteCode(code);setExisting(true);setMessage({type:'success',text:'Code prÃªt ! Partage-le Ã  ton/ta partenaire.'});}catch(e){setMessage({type:'error',text:\"Impossible de gÃ©nÃ©rer le code\"});}setLoadingCreate(false);};const copy=()=>{if(!inviteCode)return;navigator.clipboard.writeText(inviteCode).then(()=>{setMessage({type:'success',text:'Code copiÃ© dans le presse-papier'});});};const share=async()=>{if(!inviteCode)return;const url=\"\".concat(window.location.origin,\"/onboarding-couple?code=\").concat(inviteCode);if(navigator.share){try{await navigator.share({title:'Rejoins-moi ðŸ’ž',text:\"Code: \".concat(inviteCode),url});}catch(_unused2){/* annulÃ© */}}else{navigator.clipboard.writeText(url);setMessage({type:'success',text:'Lien copiÃ© (partage manuel)'});}};const handleJoin=async e=>{e.preventDefault();setMessage(null);setLoadingJoin(true);try{const code=joinCode.trim().toUpperCase();if(code.length!==6)throw new Error('Code invalide');await coupleService.join(code);setMessage({type:'success',text:'Câ€™est bon ! Redirection...'});setTimeout(()=>window.location.href='/',800);}catch(err){var _err$response,_err$response$data;setMessage({type:'error',text:((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Code invalide ou dÃ©jÃ  utilisÃ©'});}setLoadingJoin(false);};return/*#__PURE__*/_jsxs(Wrapper,{children:[/*#__PURE__*/_jsxs(Panel,{children:[/*#__PURE__*/_jsx(Title,{children:\"Cr\\xE9er & partager\"}),/*#__PURE__*/_jsx(Sub,{children:\"G\\xE9n\\xE8re un code si tu es le premier. Envoie-le ou partage directement le lien.\"}),inviteCode?/*#__PURE__*/_jsx(CodeBox,{children:inviteCode}):/*#__PURE__*/_jsx(CodeBox,{style:{opacity:.4,fontSize:24,letterSpacing:2},children:\"AUCUN CODE\"}),existing&&!message&&/*#__PURE__*/_jsx(Small,{style:{marginTop:4,color:'#036245'},children:\"Un code existe d\\xE9j\\xE0 \\u2013 partage-le ou r\\xE9g\\xE9n\\xE8re.\"}),/*#__PURE__*/_jsxs(ButtonsRow,{children:[/*#__PURE__*/_jsx(Btn,{type:\"button\",onClick:()=>createOrRefresh(false),disabled:loadingCreate,children:loadingCreate?'...':'GÃ©nÃ©rer'}),/*#__PURE__*/_jsx(Btn,{type:\"button\",onClick:()=>createOrRefresh(true),variant:\"secondary\",disabled:loadingCreate||!inviteCode,children:\"Refresh\"}),/*#__PURE__*/_jsx(Btn,{type:\"button\",onClick:copy,variant:\"secondary\",disabled:!inviteCode,children:\"Copier\"}),/*#__PURE__*/_jsx(Btn,{type:\"button\",onClick:share,variant:\"secondary\",disabled:!inviteCode,children:\"Partager\"})]}),existing&&/*#__PURE__*/_jsx(ButtonsRow,{style:{marginTop:10},children:/*#__PURE__*/_jsx(Btn,{type:\"button\",variant:\"secondary\",onClick:()=>window.location.reload(),children:\"V\\xE9rifier si reli\\xE9s\"})}),/*#__PURE__*/_jsx(Small,{children:\"Le code reste valide tant que vous n\\u2019\\xEAtes pas encore li\\xE9s.\"})]}),/*#__PURE__*/_jsxs(Panel,{children:[/*#__PURE__*/_jsx(Title,{children:\"Rejoindre\"}),/*#__PURE__*/_jsx(Sub,{children:\"Entre le code que ton/ta partenaire t\\u2019a envoy\\xE9 pour vous relier.\"}),/*#__PURE__*/_jsxs(JoinForm,{onSubmit:handleJoin,children:[/*#__PURE__*/_jsx(Input,{value:joinCode,onChange:e=>setJoinCode(e.target.value.toUpperCase()),placeholder:\"CODE\",maxLength:6}),/*#__PURE__*/_jsxs(ButtonsRow,{style:{marginTop:0},children:[/*#__PURE__*/_jsx(Btn,{type:\"submit\",disabled:loadingJoin||joinCode.length!==6,children:loadingJoin?'...':'Rejoindre'}),/*#__PURE__*/_jsx(Btn,{type:\"button\",variant:\"secondary\",onClick:()=>setJoinCode(''),children:\"Effacer\"})]})]}),/*#__PURE__*/_jsx(Small,{children:\"Le code fait 6 caract\\xE8res (A\\u2011Z, 0\\u20119).\"})]}),message&&/*#__PURE__*/_jsx(Alert,{type:message.type,children:message.text})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}