{"ast":null,"code":"// Basic auth & API service with token persistence and photo upload helper\nimport axios from 'axios';\nconst API_BASE = process.env.REACT_APP_API_BASE || process.env.REACT_APP_API_URL || 'http://localhost:5000';\nfunction getToken() {\n  return localStorage.getItem('access_token');\n}\nexport const authService = {\n  api: null,\n  init() {\n    if (this.api) return this.api;\n    this.api = axios.create({\n      baseURL: API_BASE,\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    this.api.interceptors.request.use(cfg => {\n      const t = getToken();\n      if (t) cfg.headers.Authorization = `Bearer ${t}`;\n      return cfg;\n    });\n    return this.api;\n  },\n  me: {\n    async get() {\n      return (await authService.api.get('/api/me')).data;\n    },\n    async update(fields) {\n      return (await authService.api.put('/api/me', fields)).data;\n    },\n    async uploadAvatar(file) {\n      const fd = new FormData();\n      fd.append('file', file);\n      const token = getToken();\n      const res = await fetch(`${API_BASE}/api/me`, {\n        method: 'PUT',\n        headers: token ? {\n          'Authorization': `Bearer ${token}`\n        } : {},\n        body: fd\n      });\n      if (!res.ok) throw new Error('Upload failed');\n      return res.json();\n    }\n  },\n  setToken(token) {\n    localStorage.setItem('access_token', token);\n  },\n  clearToken() {\n    localStorage.removeItem('access_token');\n  },\n  async login(email, password) {\n    var _res$data;\n    this.init();\n    const res = await this.api.post('/api/login', {\n      email,\n      password\n    });\n    if ((_res$data = res.data) !== null && _res$data !== void 0 && _res$data.access_token) this.setToken(res.data.access_token);\n    return res.data;\n  },\n  async register(name, email, password) {\n    var _res$data2;\n    this.init();\n    const res = await this.api.post('/api/register', {\n      name,\n      email,\n      password\n    });\n    if ((_res$data2 = res.data) !== null && _res$data2 !== void 0 && _res$data2.access_token) this.setToken(res.data.access_token);\n    return res.data;\n  },\n  photoService: {\n    async uploadMultipart(files) {\n      const fd = new FormData();\n      files.forEach(f => fd.append('files', f));\n      const token = getToken();\n      const res = await fetch(`${API_BASE}/api/photos`, {\n        method: 'POST',\n        headers: token ? {\n          'Authorization': `Bearer ${token}`\n        } : {},\n        body: fd\n      });\n      if (!res.ok) throw new Error('Upload failed');\n      return res.json();\n    }\n  }\n};\nauthService.init();","map":{"version":3,"names":["axios","API_BASE","process","env","REACT_APP_API_BASE","REACT_APP_API_URL","getToken","localStorage","getItem","authService","api","init","create","baseURL","headers","interceptors","request","use","cfg","t","Authorization","me","get","data","update","fields","put","uploadAvatar","file","fd","FormData","append","token","res","fetch","method","body","ok","Error","json","setToken","setItem","clearToken","removeItem","login","email","password","_res$data","post","access_token","register","name","_res$data2","photoService","uploadMultipart","files","forEach","f"],"sources":["C:/Users/sorbo/US/us-app/frontend/src/services/authService.js"],"sourcesContent":["// Basic auth & API service with token persistence and photo upload helper\r\nimport axios from 'axios';\r\n\r\nconst API_BASE = process.env.REACT_APP_API_BASE || process.env.REACT_APP_API_URL || 'http://localhost:5000';\r\n\r\nfunction getToken() {\r\n\treturn localStorage.getItem('access_token');\r\n}\r\n\r\nexport const authService = {\r\n\tapi: null,\r\n\tinit() {\r\n\t\tif (this.api) return this.api;\r\n\t\tthis.api = axios.create({\r\n\t\t\tbaseURL: API_BASE,\r\n\t\t\theaders: { 'Content-Type': 'application/json' }\r\n\t\t});\r\n\t\tthis.api.interceptors.request.use(cfg => {\r\n\t\t\tconst t = getToken();\r\n\t\t\tif (t) cfg.headers.Authorization = `Bearer ${t}`;\r\n\t\t\treturn cfg;\r\n\t\t});\r\n\t\treturn this.api;\r\n\t},\r\n\tme: {\r\n\t\tasync get() {\r\n\t\t\treturn (await authService.api.get('/api/me')).data;\r\n\t\t},\r\n\t\tasync update(fields) {\r\n\t\t\treturn (await authService.api.put('/api/me', fields)).data;\r\n\t\t},\r\n\t\tasync uploadAvatar(file) {\r\n\t\t\tconst fd = new FormData();\r\n\t\t\tfd.append('file', file);\r\n\t\t\tconst token = getToken();\r\n\t\t\tconst res = await fetch(`${API_BASE}/api/me`, {\r\n\t\t\t\tmethod: 'PUT',\r\n\t\t\t\theaders: token ? { 'Authorization': `Bearer ${token}` } : {},\r\n\t\t\t\tbody: fd\r\n\t\t\t});\r\n\t\t\tif (!res.ok) throw new Error('Upload failed');\r\n\t\t\treturn res.json();\r\n\t\t}\r\n\t},\r\n\tsetToken(token) {\r\n\t\tlocalStorage.setItem('access_token', token);\r\n\t},\r\n\tclearToken() { localStorage.removeItem('access_token'); },\r\n\tasync login(email, password) {\r\n\t\tthis.init();\r\n\t\tconst res = await this.api.post('/api/login', { email, password });\r\n\t\tif (res.data?.access_token) this.setToken(res.data.access_token);\r\n\t\treturn res.data;\r\n\t},\r\n\tasync register(name, email, password) {\r\n\t\tthis.init();\r\n\t\tconst res = await this.api.post('/api/register', { name, email, password });\r\n\t\tif (res.data?.access_token) this.setToken(res.data.access_token);\r\n\t\treturn res.data;\r\n\t},\r\n\tphotoService: {\r\n\t\tasync uploadMultipart(files) {\r\n\t\t\tconst fd = new FormData();\r\n\t\t\tfiles.forEach(f => fd.append('files', f));\r\n\t\t\tconst token = getToken();\r\n\t\t\tconst res = await fetch(`${API_BASE}/api/photos`, {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\theaders: token ? { 'Authorization': `Bearer ${token}` } : {},\r\n\t\t\t\tbody: fd\r\n\t\t\t});\r\n\t\t\tif (!res.ok) throw new Error('Upload failed');\r\n\t\t\treturn res.json();\r\n\t\t}\r\n\t}\r\n};\r\n\r\nauthService.init();\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}