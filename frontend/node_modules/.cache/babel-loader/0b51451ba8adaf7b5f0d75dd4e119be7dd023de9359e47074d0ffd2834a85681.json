{"ast":null,"code":"// frontend/src/api/index.js\nimport axios from 'axios';\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\nconst api = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Token\napi.interceptors.request.use(config => {\n  const t = localStorage.getItem('us_token');\n  if (t) config.headers.Authorization = `Bearer ${t}`;\n  return config;\n});\n\n// Erreurs globales\napi.interceptors.response.use(res => res, error => {\n  var _error$response, _error$response2;\n  const s = (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status;\n  const d = (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data;\n  if (s === 401) {\n    localStorage.removeItem('us_token');\n    localStorage.removeItem('us_user');\n    window.location.href = '/';\n  }\n  if (s === 409 && (d === null || d === void 0 ? void 0 : d.error) === 'not_in_couple') {\n    if (window.location.pathname !== '/onboarding-couple') {\n      window.location.href = '/onboarding-couple';\n    }\n  }\n  return Promise.reject(error);\n});\n\n// Services\nexport const authService = {\n  login: async (email, password) => (await api.post('/login', {\n    email,\n    password\n  })).data,\n  register: async (name, email, password) => (await api.post('/register', {\n    name,\n    email,\n    password\n  })).data,\n  getUsers: async () => (await api.get('/users')).data\n};\nexport const coupleService = {\n  me: async () => (await api.get('/couple/me')).data,\n  create: async () => (await api.post('/couple/create')).data,\n  join: async invite_code => (await api.post('/couple/join', {\n    invite_code\n  })).data,\n  refreshInvite: async () => (await api.post('/couple/invite/refresh')).data\n};\nexport default api;","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","api","create","baseURL","headers","interceptors","request","use","config","t","localStorage","getItem","Authorization","response","res","error","_error$response","_error$response2","s","status","d","data","removeItem","window","location","href","pathname","Promise","reject","authService","login","email","password","post","register","name","getUsers","get","coupleService","me","join","invite_code","refreshInvite"],"sources":["C:/Users/sorbo/US/us-app/frontend/src/api/index.js"],"sourcesContent":["// frontend/src/api/index.js\r\nimport axios from 'axios';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\n\r\nconst api = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  headers: { 'Content-Type': 'application/json' },\r\n});\r\n\r\n// Token\r\napi.interceptors.request.use((config) => {\r\n  const t = localStorage.getItem('us_token');\r\n  if (t) config.headers.Authorization = `Bearer ${t}`;\r\n  return config;\r\n});\r\n\r\n// Erreurs globales\r\napi.interceptors.response.use(\r\n  (res) => res,\r\n  (error) => {\r\n    const s = error.response?.status;\r\n    const d = error.response?.data;\r\n    if (s === 401) {\r\n      localStorage.removeItem('us_token');\r\n      localStorage.removeItem('us_user');\r\n      window.location.href = '/';\r\n    }\r\n    if (s === 409 && d?.error === 'not_in_couple') {\r\n      if (window.location.pathname !== '/onboarding-couple') {\r\n        window.location.href = '/onboarding-couple';\r\n      }\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Services\r\nexport const authService = {\r\n  login: async (email, password) => (await api.post('/login', { email, password })).data,\r\n  register: async (name, email, password) =>\r\n    (await api.post('/register', { name, email, password })).data,\r\n  getUsers: async () => (await api.get('/users')).data,\r\n};\r\n\r\nexport const coupleService = {\r\n  me: async () => (await api.get('/couple/me')).data,\r\n  create: async () => (await api.post('/couple/create')).data,\r\n  join: async (invite_code) => (await api.post('/couple/join', { invite_code })).data,\r\n  refreshInvite: async () => (await api.post('/couple/invite/refresh')).data,\r\n};\r\n\r\nexport default api;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}