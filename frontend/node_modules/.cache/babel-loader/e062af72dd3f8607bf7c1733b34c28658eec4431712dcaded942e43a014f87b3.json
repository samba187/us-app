{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/sorbo/US/us-app/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import React,{useState,useEffect}from'react';import{BrowserRouter as Router,Routes,Route,Navigate}from'react-router-dom';import styled from'styled-components';import'./App.css';// Components\nimport Login from'./components/Login';import ErrorBoundary from'./components/ErrorBoundary';import Navigation from'./components/Navigation';import PWAGuide from'./components/PWAGuide';import NotificationTester from'./components/NotificationTester';import PWADiagnostic from'./components/PWADiagnostic';import Home from'./pages/Home';import Reminders from'./pages/Reminders';import Restaurants from'./pages/Restaurants';import Activities from'./pages/Activities';import Wishlist from'./pages/Wishlist';import Photos from'./pages/Photos';import Notes from'./pages/Notes';import OnboardingCouple from'./pages/OnboardingCouple';import Profile from'./pages/Profile';// Services\n// import { authService } from './services/authService';\nimport crossNotificationService from'./services/crossNotificationService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AppContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  min-height: 100vh;\\n  background: \",\";\\n\"])),props=>props.$isAuthenticated?'var(--background-color)':'linear-gradient(135deg, #667eea 0%, #764ba2 100%)');const MainContent=styled.main(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  padding-bottom: 80px; /* Space for navigation */\\n  min-height: 100vh;\\n\"])));function App(){const[isAuthenticated,setIsAuthenticated]=useState(false);const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{console.log('🔍 App useEffect - Vérification authentification...');const token=localStorage.getItem('us_token');const userData=localStorage.getItem('us_user');console.log('Token présent:',!!token);console.log('User data présent:',!!userData);if(token){// Vérifier si le token est valide\ntry{const payload=JSON.parse(atob(token.split('.')[1]));const isValid=payload.exp*1000>Date.now();console.log('Token valide:',isValid);console.log('Token expiration:',new Date(payload.exp*1000));if(isValid&&userData){setIsAuthenticated(true);setUser(JSON.parse(userData));console.log('✅ Utilisateur authentifié');}else{console.log('❌ Token expiré ou données manquantes');localStorage.removeItem('us_token');localStorage.removeItem('us_user');}}catch(error){console.error('❌ Erreur parsing token:',error);localStorage.removeItem('us_token');localStorage.removeItem('us_user');}}else{console.log('❌ Aucun token trouvé');}setLoading(false);console.log('🏁 App initialization complete');},[]);// Démarrer les notifications croisées quand l'utilisateur est connecté\nuseEffect(()=>{if(isAuthenticated&&user){crossNotificationService.startCrossNotifications();// Arrêter les notifications lors de la déconnexion\nreturn()=>{crossNotificationService.stopCrossNotifications();};}},[isAuthenticated,user]);const handleLogin=(token,userData)=>{localStorage.setItem('us_token',token);localStorage.setItem('us_user',JSON.stringify(userData));setIsAuthenticated(true);setUser(userData);};const handleLogout=()=>{localStorage.removeItem('us_token');localStorage.removeItem('us_user');setIsAuthenticated(false);setUser(null);};if(loading){return/*#__PURE__*/_jsx(AppContainer,{children:/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'100vh',color:'white',fontSize:'18px'},children:\"Chargement... \\u2764\\uFE0F\"})});}if(!isAuthenticated){return/*#__PURE__*/_jsx(ErrorBoundary,{children:/*#__PURE__*/_jsxs(AppContainer,{$isAuthenticated:isAuthenticated,children:[/*#__PURE__*/_jsx(Login,{onLogin:handleLogin}),/*#__PURE__*/_jsx(PWADiagnostic,{})]})});}return/*#__PURE__*/_jsx(ErrorBoundary,{children:/*#__PURE__*/_jsx(AppContainer,{$isAuthenticated:isAuthenticated,children:/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsx(MainContent,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{user:user})}),/*#__PURE__*/_jsx(Route,{path:\"/onboarding-couple\",element:/*#__PURE__*/_jsx(OnboardingCouple,{})}),/*#__PURE__*/_jsx(Route,{path:\"/reminders\",element:/*#__PURE__*/_jsx(Reminders,{})}),/*#__PURE__*/_jsx(Route,{path:\"/restaurants\",element:/*#__PURE__*/_jsx(Restaurants,{})}),/*#__PURE__*/_jsx(Route,{path:\"/activities\",element:/*#__PURE__*/_jsx(Activities,{})}),/*#__PURE__*/_jsx(Route,{path:\"/wishlist\",element:/*#__PURE__*/_jsx(Wishlist,{})}),/*#__PURE__*/_jsx(Route,{path:\"/photos\",element:/*#__PURE__*/_jsx(Photos,{})}),/*#__PURE__*/_jsx(Route,{path:\"/notes\",element:/*#__PURE__*/_jsx(Notes,{})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsx(Profile,{onLogout:handleLogout})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})]})}),window.location.pathname!=='/onboarding-couple'&&/*#__PURE__*/_jsx(Navigation,{}),/*#__PURE__*/_jsx(PWAGuide,{}),/*#__PURE__*/_jsx(NotificationTester,{}),/*#__PURE__*/_jsx(PWADiagnostic,{})]})})});}export default App;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}