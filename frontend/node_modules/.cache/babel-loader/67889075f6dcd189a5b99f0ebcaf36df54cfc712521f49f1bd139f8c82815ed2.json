{"ast":null,"code":"import React,{useEffect,useState}from'react';import{coupleService}from'../services/authService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Home(){const[loading,setLoading]=useState(true);const[inCouple,setInCouple]=useState(false);const[inviteCode,setInviteCode]=useState(null);const[partner,setPartner]=useState(null);useEffect(()=>{(async()=>{try{const cm=await coupleService.me();setInCouple(!!cm.in_couple);setInviteCode(cm.invite_code||null);if(cm.members&&cm.members.length>1){const me=JSON.parse(localStorage.getItem('us_user')||'{}');setPartner(cm.members.find(m=>m.email!==(me===null||me===void 0?void 0:me.email))||null);}}finally{setLoading(false);}})();},[]);const handleInvite=async()=>{try{let code=inviteCode;if(!code){const cm=await coupleService.me();code=cm.invite_code;if(!code){const res=await coupleService.create();// crÃ©e/refait le code si besoin\ncode=res.invite_code;}}setInviteCode(code);const shareUrl=\"\".concat(window.location.origin,\"/onboarding-couple?code=\").concat(code);alert(\"Code d\\u2019invitation : \".concat(code,\"\\n\\nLien \\xE0 envoyer :\\n\").concat(shareUrl));if(navigator.share){try{await navigator.share({title:'Notre app',text:\"Code : \".concat(code),url:shareUrl});}catch(_unused){}}}catch(_unused2){alert('Impossible de gÃ©nÃ©rer le code. RÃ©essaie.');}};if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"Chargement\\u2026\"});return/*#__PURE__*/_jsx(\"div\",{children:!inCouple?/*#__PURE__*/_jsxs(\"div\",{style:{margin:'16px 0',padding:16,border:'1px solid #eee',borderRadius:12},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,marginBottom:8},children:\"En attente\\u2026 \\uD83D\\uDC95\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Invite ta copine \\xE0 rejoindre l\\u2019app !\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleInvite,style:{marginTop:12},children:\"G\\xE9n\\xE9rer / afficher le code\"}),inviteCode&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8,fontFamily:'monospace'},children:[\"Code : \",/*#__PURE__*/_jsx(\"strong\",{children:inviteCode})]})]}):/*#__PURE__*/_jsx(\"div\",{style:{margin:'16px 0',padding:16,border:'1px solid #eee',borderRadius:12},children:/*#__PURE__*/_jsxs(\"div\",{children:[\"\\uD83D\\uDC91 Vous \\xEAtes reli\\xE9s \",partner?\"avec \".concat(partner.name):'',\" \\u2014 profitez de l\\u2019app !\"]})})});}","map":{"version":3,"names":["React","useEffect","useState","coupleService","jsx","_jsx","jsxs","_jsxs","Home","loading","setLoading","inCouple","setInCouple","inviteCode","setInviteCode","partner","setPartner","cm","me","in_couple","invite_code","members","length","JSON","parse","localStorage","getItem","find","m","email","handleInvite","code","res","create","shareUrl","concat","window","location","origin","alert","navigator","share","title","text","url","_unused","_unused2","children","style","margin","padding","border","borderRadius","fontWeight","marginBottom","onClick","marginTop","fontFamily","name"],"sources":["C:/Users/sorbo/US/us-app/frontend/src/pages/Home.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { coupleService } from '../services/authService';\r\n\r\nexport default function Home() {\r\n  const [loading, setLoading] = useState(true);\r\n  const [inCouple, setInCouple] = useState(false);\r\n  const [inviteCode, setInviteCode] = useState(null);\r\n  const [partner, setPartner] = useState(null);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        const cm = await coupleService.me();\r\n        setInCouple(!!cm.in_couple);\r\n        setInviteCode(cm.invite_code || null);\r\n        if (cm.members && cm.members.length > 1) {\r\n          const me = JSON.parse(localStorage.getItem('us_user') || '{}');\r\n          setPartner(cm.members.find(m => m.email !== me?.email) || null);\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  const handleInvite = async () => {\r\n    try {\r\n      let code = inviteCode;\r\n      if (!code) {\r\n        const cm = await coupleService.me();\r\n        code = cm.invite_code;\r\n        if (!code) {\r\n          const res = await coupleService.create(); // crÃ©e/refait le code si besoin\r\n          code = res.invite_code;\r\n        }\r\n      }\r\n      setInviteCode(code);\r\n      const shareUrl = `${window.location.origin}/onboarding-couple?code=${code}`;\r\n      alert(`Code dâ€™invitation : ${code}\\n\\nLien Ã  envoyer :\\n${shareUrl}`);\r\n      if (navigator.share) {\r\n        try { await navigator.share({ title: 'Notre app', text: `Code : ${code}`, url: shareUrl }); } catch {}\r\n      }\r\n    } catch {\r\n      alert('Impossible de gÃ©nÃ©rer le code. RÃ©essaie.');\r\n    }\r\n  };\r\n\r\n  if (loading) return <div>Chargementâ€¦</div>;\r\n\r\n  return (\r\n    <div>\r\n      {!inCouple ? (\r\n        <div style={{margin:'16px 0', padding:16, border:'1px solid #eee', borderRadius:12}}>\r\n          <div style={{fontWeight:700, marginBottom:8}}>En attenteâ€¦ ðŸ’•</div>\r\n          <div>Invite ta copine Ã  rejoindre lâ€™app !</div>\r\n          <button onClick={handleInvite} style={{marginTop:12}}>GÃ©nÃ©rer / afficher le code</button>\r\n          {inviteCode && <div style={{marginTop:8, fontFamily:'monospace'}}>Code : <strong>{inviteCode}</strong></div>}\r\n        </div>\r\n      ) : (\r\n        <div style={{margin:'16px 0', padding:16, border:'1px solid #eee', borderRadius:12}}>\r\n          <div>ðŸ’‘ Vous Ãªtes reliÃ©s {partner ? `avec ${partner.name}` : ''} â€” profitez de lâ€™app !</div>\r\n        </div>\r\n      )}\r\n\r\n      {/* â€¦ le reste de ta Home (cartes, etc.) */}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}