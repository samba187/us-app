{"ast":null,"code":"import _objectSpread from\"C:/Users/sorbo/US/us-app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _taggedTemplateLiteral from\"C:/Users/sorbo/US/us-app/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject0,_templateObject1,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15,_templateObject16,_templateObject17,_templateObject18,_templateObject19,_templateObject20,_templateObject21,_templateObject22,_templateObject23,_templateObject24,_templateObject25,_templateObject26,_templateObject27;import React,{useState,useEffect}from'react';import styled from'styled-components';import{FiPlus,FiHeart,FiExternalLink}from'react-icons/fi';import{wishlistService,photoService}from'../services/authService';import crossNotificationService from'../services/crossNotificationService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const WishlistContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  padding: 20px;\\n  padding-bottom: 120px;\\n\"])));const Header=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  margin-bottom: 30px;\\n\"])));const Title=styled.h1(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  font-size: 28px;\\n  font-weight: 700;\\n  color: var(--text-color);\\n\"])));const AddButton=styled.button(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  background: linear-gradient(135deg, #ff6b8a, #4ecdc4);\\n  color: white;\\n  border: none;\\n  padding: 12px 20px;\\n  border-radius: 12px;\\n  font-weight: 600;\\n  cursor: pointer;\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n\"])));const WishlistCard=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  background: white;\\n  border-radius: 16px;\\n  box-shadow: var(--shadow);\\n  margin-bottom: 15px;\\n  overflow: hidden;\\n\"])));const WishlistImage=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  height: 120px;\\n  background: \",\";\\n  background-size: cover;\\n  background-position: center;\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n\"])),props=>{if(props.image){// Gérer les différents formats de chemin d'image\nconst imagePath=props.image.startsWith('http')?props.image:props.image.startsWith('/')?props.image:\"/\".concat(props.image);return\"url(\".concat(imagePath,\")\");}return'linear-gradient(135deg, #f093fb, #f5576c)';});const WishlistIcon=styled.div(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  font-size: 48px;\\n  color: white;\\n  opacity: 0.8;\\n\"])));const StatusBadge=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  top: 10px;\\n  right: 10px;\\n  padding: 6px 12px;\\n  border-radius: 20px;\\n  font-size: 12px;\\n  font-weight: 600;\\n  background: \",\";\\n  color: white;\\n\"])),props=>{switch(props.status){case'idea':return'rgba(255, 165, 2, 0.9)';case'bought':return'rgba(46, 213, 115, 0.9)';case'gifted':return'rgba(255, 107, 138, 0.9)';default:return'rgba(0, 0, 0, 0.7)';}});const WishlistContent=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  padding: 20px;\\n\"])));const WishlistTitle=styled.h3(_templateObject0||(_templateObject0=_taggedTemplateLiteral([\"\\n  font-size: 18px;\\n  font-weight: 600;\\n  color: var(--text-color);\\n  margin-bottom: 8px;\\n\"])));const ForUser=styled.p(_templateObject1||(_templateObject1=_taggedTemplateLiteral([\"\\n  color: var(--primary-color);\\n  font-size: 14px;\\n  margin-bottom: 10px;\\n  font-weight: 600;\\n\"])));const WishlistDescription=styled.p(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  color: var(--text-color);\\n  font-size: 14px;\\n  line-height: 1.4;\\n  margin-bottom: 15px;\\n\"])));const WishlistActions=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  display: flex;\\n  gap: 8px;\\n  align-items: center;\\n\"])));const ActionButton=styled.button(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  padding: 8px 12px;\\n  border: 1px solid var(--border-color);\\n  border-radius: 8px;\\n  background: white;\\n  color: var(--text-color);\\n  font-size: 12px;\\n  cursor: pointer;\\n  transition: all 0.3s ease;\\n\\n  &:hover {\\n    background: var(--background-color);\\n  }\\n\\n  &.active {\\n    background: var(--primary-color);\\n    color: white;\\n    border-color: var(--primary-color);\\n  }\\n\"])));const LinkButton=styled.a(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  padding: 8px 12px;\\n  border: 1px solid var(--primary-color);\\n  border-radius: 8px;\\n  background: white;\\n  color: var(--primary-color);\\n  font-size: 12px;\\n  text-decoration: none;\\n  display: flex;\\n  align-items: center;\\n  gap: 4px;\\n  transition: all 0.3s ease;\\n\\n  &:hover {\\n    background: var(--primary-color);\\n    color: white;\\n  }\\n\"])));const EditDeleteRow=styled.div(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\\n  display: flex;\\n  gap: 8px;\\n  margin-top: 10px;\\n\"])));const EditButton=styled.button(_templateObject15||(_templateObject15=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  padding: 6px 10px;\\n  border: 1px solid #4ecdc4;\\n  border-radius: 6px;\\n  background: white;\\n  color: #4ecdc4;\\n  font-size: 11px;\\n  cursor: pointer;\\n\\n  &:hover {\\n    background: #4ecdc4;\\n    color: white;\\n  }\\n\"])));const DeleteButton=styled.button(_templateObject16||(_templateObject16=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  padding: 6px 10px;\\n  border: 1px solid #ff6b8a;\\n  border-radius: 6px;\\n  background: white;\\n  color: #ff6b8a;\\n  font-size: 11px;\\n  cursor: pointer;\\n\\n  &:hover {\\n    background: #ff6b8a;\\n    color: white;\\n  }\\n\"])));const Modal=styled.div(_templateObject17||(_templateObject17=_taggedTemplateLiteral([\"\\n  position: fixed;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  background: rgba(0, 0, 0, 0.5);\\n  display: \",\";\\n  align-items: center;\\n  justify-content: center;\\n  z-index: 2000;\\n  padding: 20px;\\n\"])),props=>props.show?'flex':'none');const ModalContent=styled.div(_templateObject18||(_templateObject18=_taggedTemplateLiteral([\"\\n  background: white;\\n  border-radius: 20px;\\n  padding: 30px;\\n  width: 100%;\\n  max-width: 400px;\\n  max-height: 80vh;\\n  overflow-y: auto;\\n\"])));const ModalTitle=styled.h2(_templateObject19||(_templateObject19=_taggedTemplateLiteral([\"\\n  margin-bottom: 20px;\\n  color: var(--text-color);\\n\"])));const Form=styled.form(_templateObject20||(_templateObject20=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  gap: 15px;\\n\"])));const Input=styled.input(_templateObject21||(_templateObject21=_taggedTemplateLiteral([\"\\n  padding: 12px;\\n  border: 2px solid var(--border-color);\\n  border-radius: 8px;\\n  font-size: 16px;\\n\\n  &:focus {\\n    outline: none;\\n    border-color: var(--primary-color);\\n  }\\n\"])));const TextArea=styled.textarea(_templateObject22||(_templateObject22=_taggedTemplateLiteral([\"\\n  padding: 12px;\\n  border: 2px solid var(--border-color);\\n  border-radius: 8px;\\n  font-size: 16px;\\n  min-height: 80px;\\n  resize: vertical;\\n  font-family: inherit;\\n\\n  &:focus {\\n    outline: none;\\n    border-color: var(--primary-color);\\n  }\\n\"])));const FileInput=styled.input(_templateObject23||(_templateObject23=_taggedTemplateLiteral([\"\\n  padding: 12px;\\n  border: 2px solid var(--border-color);\\n  border-radius: 8px;\\n  font-size: 16px;\\n\\n  &:focus {\\n    outline: none;\\n    border-color: var(--primary-color);\\n  }\\n\"])));const FormButtons=styled.div(_templateObject24||(_templateObject24=_taggedTemplateLiteral([\"\\n  display: flex;\\n  gap: 10px;\\n  margin-top: 20px;\\n\"])));const Button=styled.button(_templateObject25||(_templateObject25=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  padding: 12px;\\n  border-radius: 8px;\\n  font-weight: 600;\\n  cursor: pointer;\\n  border: none;\\n\"])));const PrimaryButton=styled(Button)(_templateObject26||(_templateObject26=_taggedTemplateLiteral([\"\\n  background: linear-gradient(135deg, #ff6b8a, #4ecdc4);\\n  color: white;\\n\"])));const SecondaryButton=styled(Button)(_templateObject27||(_templateObject27=_taggedTemplateLiteral([\"\\n  background: var(--border-color);\\n  color: var(--text-color);\\n\"])));function Wishlist(){const[wishlist,setWishlist]=useState([]);const[loading,setLoading]=useState(true);const[showModal,setShowModal]=useState(false);const[editingItem,setEditingItem]=useState(null);const[formData,setFormData]=useState({title:'',description:'',link_url:'',files:null});useEffect(()=>{loadWishlist();},[]);const loadWishlist=async()=>{try{const data=await wishlistService.getAll();setWishlist(data);}catch(error){console.error('Erreur lors du chargement de la wishlist:',error);}setLoading(false);};const updateStatus=async(id,newStatus)=>{try{await wishlistService.update(id,{status:newStatus});loadWishlist();}catch(error){console.error('Erreur lors de la mise à jour de l\\'item:',error);}};const handleSubmit=async e=>{e.preventDefault();try{let imageUrl='';// Upload de l'image si présente\nif(formData.files&&formData.files.length>0){const uploadData=new FormData();uploadData.append('files',formData.files[0]);// Prendre la première image\nuploadData.append('category','wishlist');try{const uploadResult=await photoService.uploadMultipart(uploadData);if(uploadResult&&uploadResult.length>0){imageUrl=uploadResult[0].path;// Utiliser le path de l'image uploadée\n}}catch(uploadError){console.error('Erreur upload image:',uploadError);}}const itemData={title:formData.title,description:formData.description,link_url:formData.link_url,image_url:imageUrl||(editingItem===null||editingItem===void 0?void 0:editingItem.image_url)||''};if(editingItem){await wishlistService.update(editingItem._id,itemData);}else{await wishlistService.create(itemData);// Déclencher les notifications croisées\nsetTimeout(()=>{crossNotificationService.triggerImmediateCheck();},1000);}setShowModal(false);setEditingItem(null);setFormData({title:'',description:'',link_url:'',files:null});loadWishlist();}catch(error){console.error('Erreur:',error);}};const handleEdit=item=>{setEditingItem(item);setFormData({title:item.title,description:item.description||'',link_url:item.link_url||'',for_user:item.for_user||'user1',files:null});setShowModal(true);};const handleDelete=async id=>{if(window.confirm('Supprimer cet élément ?')){try{await wishlistService.delete(id);loadWishlist();}catch(error){console.error('Erreur suppression:',error);}}};const getStatusLabel=status=>{switch(status){case'idea':return'Idée';case'bought':return'Acheté';case'gifted':return'Offert';default:return status;}};const getUserName=item=>{const currentUser=JSON.parse(localStorage.getItem('us_user')||'{}');// Si l'item a été créé par l'utilisateur actuel\nif(item.created_by===currentUser._id){return'Toi';}else{// Si l'item a été créé par le/la partenaire  \nreturn'Ton/ta partenaire';}};if(loading){return/*#__PURE__*/_jsx(WishlistContainer,{children:/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',marginTop:'50px'},children:\"Chargement de la wishlist...\"})});}return/*#__PURE__*/_jsxs(WishlistContainer,{className:\"fade-in\",children:[/*#__PURE__*/_jsxs(Header,{children:[/*#__PURE__*/_jsx(Title,{children:\"Wishlist\"}),/*#__PURE__*/_jsxs(AddButton,{onClick:()=>{setEditingItem(null);setFormData({title:'',description:'',link_url:'',files:null});setShowModal(true);},children:[/*#__PURE__*/_jsx(FiPlus,{}),\" Ajouter\"]})]}),wishlist.map(item=>/*#__PURE__*/_jsxs(WishlistCard,{children:[/*#__PURE__*/_jsxs(WishlistImage,{image:item.image_url,children:[!item.image_url&&/*#__PURE__*/_jsx(WishlistIcon,{children:\"\\uD83C\\uDF81\"}),/*#__PURE__*/_jsx(StatusBadge,{status:item.status,children:getStatusLabel(item.status)})]}),/*#__PURE__*/_jsxs(WishlistContent,{children:[/*#__PURE__*/_jsx(WishlistTitle,{children:item.title}),/*#__PURE__*/_jsxs(ForUser,{children:[\"\\uD83D\\uDC9D Pour \",getUserName(item)]}),item.description&&/*#__PURE__*/_jsx(WishlistDescription,{children:item.description}),/*#__PURE__*/_jsxs(WishlistActions,{children:[/*#__PURE__*/_jsx(ActionButton,{className:item.status==='idea'?'active':'',onClick:()=>updateStatus(item._id,'idea'),children:\"Id\\xE9e\"}),/*#__PURE__*/_jsx(ActionButton,{className:item.status==='bought'?'active':'',onClick:()=>updateStatus(item._id,'bought'),children:\"Achet\\xE9\"}),/*#__PURE__*/_jsx(ActionButton,{className:item.status==='gifted'?'active':'',onClick:()=>updateStatus(item._id,'gifted'),children:\"Offert\"}),item.link_url&&/*#__PURE__*/_jsxs(LinkButton,{href:item.link_url,target:\"_blank\",rel:\"noopener noreferrer\",children:[/*#__PURE__*/_jsx(FiExternalLink,{}),\" Voir\"]})]}),/*#__PURE__*/_jsxs(EditDeleteRow,{children:[/*#__PURE__*/_jsx(EditButton,{onClick:()=>handleEdit(item),children:\"Modifier\"}),/*#__PURE__*/_jsx(DeleteButton,{onClick:()=>handleDelete(item._id),children:\"Supprimer\"})]})]})]},item._id)),wishlist.length===0&&/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'40px',color:'var(--text-light)'},children:[/*#__PURE__*/_jsx(FiHeart,{size:48,style:{marginBottom:'20px',opacity:0.3}}),/*#__PURE__*/_jsx(\"p\",{children:\"Aucune id\\xE9e cadeau pour le moment\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'14px',marginTop:'10px'},children:\"Ajoutez vos envies et id\\xE9es cadeaux ! \\uD83C\\uDF81\"})]}),/*#__PURE__*/_jsx(Modal,{show:showModal,onClick:()=>setShowModal(false),children:/*#__PURE__*/_jsxs(ModalContent,{onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(ModalTitle,{children:editingItem?'Modifier l\\'élément':'Nouveau souhait'}),/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(Input,{type:\"text\",placeholder:\"Titre\",value:formData.title,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{title:e.target.value})),required:true}),/*#__PURE__*/_jsx(TextArea,{placeholder:\"Description\",value:formData.description,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{description:e.target.value}))}),/*#__PURE__*/_jsx(Input,{type:\"url\",placeholder:\"Lien (optionnel)\",value:formData.link_url,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{link_url:e.target.value}))}),/*#__PURE__*/_jsx(FileInput,{type:\"file\",multiple:true,accept:\"image/*\",onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{files:e.target.files}))}),/*#__PURE__*/_jsxs(FormButtons,{children:[/*#__PURE__*/_jsx(SecondaryButton,{type:\"button\",onClick:()=>setShowModal(false),children:\"Annuler\"}),/*#__PURE__*/_jsx(PrimaryButton,{type:\"submit\",children:editingItem?'Modifier':'Créer'})]})]})]})})]});}export default Wishlist;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}